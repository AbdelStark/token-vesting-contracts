<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/LinearTokenVesting.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> LinearTokenVesting.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/34</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/16</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/34</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// contracts/LinearTokenVesting.sol
// SPDX-License-Identifier: Apache-2.0
pragma solidity &gt;=0.8.4;
&nbsp;
import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/utils/math/Math.sol";
import "@openzeppelin/contracts/utils/math/SafeMath.sol";
&nbsp;
/**
 * @title LinearTokenVesting
 * @dev A token holder contract that can release its token balance gradually like a
 * typical vesting scheme, with a cliff and vesting period. Optionally revocable by the
 * owner.
 * Adapted from:
 * https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v1.12.0/contracts/token/ERC20/TokenVesting.sol
 * contract by OpenZeppelin
 */
contract LinearTokenVesting is Ownable, ReentrancyGuard{
    using SafeMath for uint256;
    uint256 public constant ZERO = 0;
&nbsp;
    // beneficiary of tokens after they are released
    address public beneficiary;
    // cliff period in seconds
    uint256 public cliff;
    // start time of the vesting period
    uint256 public start;
    // duration of the vesting period in seconds
    uint256 public duration;
    // whether or not the vesting is revocable
    bool public revocable;
    // amount of tokens released
    uint256 public released;
    // address of the ERC20 token
    IERC20 immutable public token;
&nbsp;
    event Released(uint256 amount);
    event Revoked();
&nbsp;
    /**
    * @notice Only allow calls from the beneficiary of the vesting contract
    */
<span class="fstat-no" title="function not covered" >    modifier onlyBeneficiary() {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.sender == beneficiary)</span>;
        _;
    }
&nbsp;
    /**
     * @dev Creates a vesting contract that vests its balance of any ERC20 token to the
     * _beneficiary, gradually in a linear fashion until _start + _duration. By then all
     * of the balance will have vested.
     * @param _beneficiary address of the beneficiary to whom vested tokens are transferred
     * @param _cliff duration in seconds of the cliff in which tokens will begin to vest
     * @param _duration duration in seconds of the period in which the tokens will vest
     * @param _revocable whether the vesting is revocable or not
     * @param _token address of the ERC20 token contract
     */
<span class="fstat-no" title="function not covered" >    constructor(</span>
        address _beneficiary,
        uint256 _start,
        uint256 _cliff,
        uint256 _duration,
        bool _revocable,
        address _token
    ) {
<span class="cstat-no" title="statement not covered" >        require(_beneficiary != address(0x0))</span>;
<span class="cstat-no" title="statement not covered" >        require(_cliff &lt;= _duration)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        beneficiary = _beneficiary</span>;
<span class="cstat-no" title="statement not covered" >        start = _start</span>;
<span class="cstat-no" title="statement not covered" >        cliff = _start.add(_cliff)</span>;
<span class="cstat-no" title="statement not covered" >        duration = _duration</span>;
<span class="cstat-no" title="statement not covered" >        revocable = _revocable</span>;
<span class="cstat-no" title="statement not covered" >        token = IERC20(_token)</span>;
    }
&nbsp;
    receive() external payable {}
&nbsp;
<span class="fstat-no" title="function not covered" >    fallback() external payable {}</span>
    /**
     * @notice Transfers vested tokens to beneficiary.
     */
<span class="fstat-no" title="function not covered" >    function release() onlyBeneficiary nonReentrant public {</span>
<span class="cstat-no" title="statement not covered" >        uint256 vested = vestedAmount();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(vested &gt; ZERO)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        released = released.add(vested)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        token.transfer(beneficiary, vested)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit Released(vested);</span>
    }
&nbsp;
    /**
     * @notice Allow the beneficiary to change its address
     * @param target the address to transfer the right to
     */
<span class="fstat-no" title="function not covered" >    function changeBeneficiary(address target) onlyBeneficiary public {</span>
<span class="cstat-no" title="statement not covered" >        require(target != address(0x0))</span>;
<span class="cstat-no" title="statement not covered" >        beneficiary = target</span>;
    }
&nbsp;
    /**
     * @notice Allows the owner to revoke the vesting. Tokens already vested remain in the contract.
     */
<span class="fstat-no" title="function not covered" >    function revoke() onlyOwner public {</span>
<span class="cstat-no" title="statement not covered" >        require(revocable, "TokenVesting: vesting is not revocable")</span>;
<span class="cstat-no" title="statement not covered" >        uint256 balance = token.balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >        uint256 vested = vestedAmount();</span>
<span class="cstat-no" title="statement not covered" >        uint256 revokedAmount = balance.sub(vested);</span>
<span class="cstat-no" title="statement not covered" >        token.transfer(owner(), revokedAmount)</span>;
<span class="cstat-no" title="statement not covered" >        emit Revoked();</span>
    }
&nbsp;
    /**
     * @dev Calculates the amount that has already vested but hasn't been released yet.
     */
<span class="fstat-no" title="function not covered" >    function vestedAmount() public view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        if (block.timestamp &lt; cliff) {</span>
<span class="cstat-no" title="statement not covered" >            return 0;</span>
        } else <span class="cstat-no" title="statement not covered" >if (block.timestamp &gt;= start + duration) {</span>
<span class="cstat-no" title="statement not covered" >            return token.balanceOf(address(this));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            uint256 currentBalance = token.balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >            uint256 totalBalance = currentBalance.add(released);</span>
<span class="cstat-no" title="statement not covered" >            uint256 vested = totalBalance.mul(block.timestamp - start).div(duration);</span>
<span class="cstat-no" title="statement not covered" >            uint256 unreleased = vested.sub(released);</span>
            // currentBalance can be 0 in case of vesting being revoked earlier.
<span class="cstat-no" title="statement not covered" >            return Math.min(currentBalance, unreleased);</span>
        }
    }
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >    function getBeneficiary() public view returns(address){</span>
<span class="cstat-no" title="statement not covered" >        return beneficiary;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getToken() public view returns(address){</span>
<span class="cstat-no" title="statement not covered" >        return address(token);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getReleased() public view returns(uint256){</span>
<span class="cstat-no" title="statement not covered" >        return released;</span>
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed Jun 02 2021 10:52:50 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
